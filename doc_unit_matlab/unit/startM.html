<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of startM</title>
  <meta name="keywords" content="startM">
  <meta name="description" content="STARTM - function to initialise a model structure in case user has been">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">unit</a> &gt; startM.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for unit&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>startM
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>STARTM - function to initialise a model structure in case user has been</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function M = startM(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> STARTM - function to initialise a model structure in case user has been
 very sparse in defining it.  

 This function tries to determine the modle type, the number of inputs and
 outputs, and the order of the various polynomials or state-space matrices
 for the system.

 This function is not meant to ever be
 called directly by a user - instead it is just an auxiliary function that is
 used internally by other routines; most importantly EST.m

 Usage is: 

 M = startM(Z,Min)

 Where

 Z     : Data for the estimation experiment.  Refer to est.m for
         specification of its format. 
 Min   : Whatever has already been specified in the model structure

 Written by Brett Ninness  School of EE &amp; CS
            Adrian Wills   University of Newcastle
                           Australia</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="startNL.html" class="code" title="function M = startNL(Z,M)">startNL</a>	STARTNL - function to initialise estimate of any nonlinear components</li><li><a href="startZ.html" class="code" title="function Z = startZ(Z)">startZ</a>	This function accepts a data structure and tries to interpret what type</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="barx.html" class="code" title="function G = barx(Z,M,OPT)">barx</a>	This routine takes a record of input-output data [y,u] and fits</li><li><a href="demo_fir.html" class="code" title="">demo_fir</a>	Running this demos least squares estimation</li><li><a href="demo_mimo_freq.html" class="code" title="">demo_mimo_freq</a>	Running this demo's ML estimation of MIMO systems from frequency</li><li><a href="est.html" class="code" title="function G = est(Z,M,OPT)">est</a>	EST: Computes an estimate of either a Box-Jenkins model or a state space</li><li><a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>	This function does least squares fitting for FIR models based on</li><li><a href="gn.html" class="code" title="function G = gn(Z,M,OPT);">gn</a>	This function calls underlying gradient-based search algorithms, based on</li><li><a href="m2f.html" class="code" title="function G = m2f(M);">m2f</a>	M2F - function to compute the frequency response of a linear time</li><li><a href="nonpar.html" class="code" title="function G = nonpar(Z,M,OPT);">nonpar</a>	NONPAR This routine takes a record of input-output data [y,u] and</li><li><a href="onid.html" class="code" title="function G = onid(Z,M,OPT)">onid</a>	This function does least squares fitting with respect to orthogonal</li><li><a href="postdist.html" class="code" title="function G = postdist(Z,M,OPT)">postdist</a>	POSTDIST: Compute the posterior distribution marginals p(theta_k|y) of parameters</li><li><a href="sid.html" class="code" title="function G = sid(Z,M,OPT);">sid</a>	This function estimates a state-space model for a possibly</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% STARTM - function to initialise a model structure in case user has been</span>
0002 <span class="comment">% very sparse in defining it.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% This function tries to determine the modle type, the number of inputs and</span>
0005 <span class="comment">% outputs, and the order of the various polynomials or state-space matrices</span>
0006 <span class="comment">% for the system.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% This function is not meant to ever be</span>
0009 <span class="comment">% called directly by a user - instead it is just an auxiliary function that is</span>
0010 <span class="comment">% used internally by other routines; most importantly EST.m</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Usage is:</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% M = startM(Z,Min)</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% Where</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% Z     : Data for the estimation experiment.  Refer to est.m for</span>
0019 <span class="comment">%         specification of its format.</span>
0020 <span class="comment">% Min   : Whatever has already been specified in the model structure</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% Written by Brett Ninness  School of EE &amp; CS</span>
0023 <span class="comment">%            Adrian Wills   University of Newcastle</span>
0024 <span class="comment">%                           Australia</span>
0025 
0026 <span class="comment">% Copyright (C) Brett Ninness.</span>
0027 
0028 <a name="_sub0" href="#_subfunctions" class="code">function M = startM(varargin)</a>
0029 
0030 <span class="comment">%-------------------------- HOW IT WORKS ----------------------------------</span>
0031 <span class="comment">% 1. First up, this function tries to determine if both a data set Z and an</span>
0032 <span class="comment">%    initial model M are supplied.</span>
0033 <span class="comment">% 2. Once this is dertermined a default model &quot;m&quot; is specified. This should</span>
0034 <span class="comment">%    contain almost all possible variables that can be set during a call to</span>
0035 <span class="comment">%    any est() routine.</span>
0036 <span class="comment">% 3. Then the hard bit, determine what type of model is being asked for. If</span>
0037 <span class="comment">%    M.type is specified then it will determine all further decisions. If,</span>
0038 <span class="comment">%    on the other hand, it is not specified then some default decisions are</span>
0039 <span class="comment">%    made based on what else has been given by the data set Z and initial</span>
0040 <span class="comment">%    model M. If nothing is available, then the default model is returned.</span>
0041 <span class="comment">% 4. After the model type is finalised, default values for that type are</span>
0042 <span class="comment">%    populated on a case-by-case basis (via a switch).</span>
0043 <span class="comment">% 5. Finally, any remaining defaults are populated and the new model</span>
0044 <span class="comment">%    structure is returned.</span>
0045 <span class="comment">%--------------------------------------------------------------------------</span>
0046 
0047 <span class="comment">%Get the number of input arguments</span>
0048 numargs = length(varargin);
0049 
0050 <span class="comment">%------------------------------ Get Z and M -------------------------------</span>
0051 <span class="comment">%Based on the number and type of input arguments, we will make certain</span>
0052 <span class="comment">%default decisions</span>
0053 <span class="keyword">switch</span> nargin
0054  <span class="keyword">case</span> 0
0055   <span class="comment">% No model or data supplied so set to defaults</span>
0056   ny = 1;
0057   nu = 1;
0058   Z  = struct();
0059   M  = struct();
0060   
0061  <span class="keyword">case</span> 1  <span class="comment">% Either just Z or just M</span>
0062   
0063   Z  = struct();
0064   nu = 1;
0065   ny = 1;
0066   
0067   <span class="comment">% Determine M based on what was passed in</span>
0068   <span class="keyword">if</span> isa(varargin{1},<span class="string">'char'</span>),
0069    M.type = varargin{1};
0070   <span class="keyword">elseif</span> isa(varargin{1},<span class="string">'struct'</span>),
0071    <span class="keyword">if</span> isfield(varargin{1},<span class="string">'type'</span>),
0072     <span class="keyword">if</span> strcmpi(varargin{1}.type,{<span class="string">'time'</span>,<span class="string">'frequency'</span>}),
0073      M = [];
0074     <span class="keyword">else</span>
0075      M  = varargin{1};
0076      <span class="keyword">if</span> isfield(M,<span class="string">'nu'</span>),
0077       nu = M.nu;
0078      <span class="keyword">end</span>
0079      <span class="keyword">if</span> isfield(M,<span class="string">'ny'</span>),
0080       ny = M.ny;
0081      <span class="keyword">end</span>
0082     <span class="keyword">end</span>
0083    <span class="keyword">else</span>
0084     M  = varargin{1};
0085     <span class="keyword">if</span> isfield(M,<span class="string">'nu'</span>),
0086      nu = M.nu;
0087     <span class="keyword">end</span>
0088     <span class="keyword">if</span> isfield(M,<span class="string">'ny'</span>),
0089      ny = M.ny;
0090     <span class="keyword">end</span>
0091    <span class="keyword">end</span>
0092   <span class="keyword">elseif</span> isa(varargin{1},<span class="string">'numeric'</span>),
0093    M.nA = varargin{1};
0094   <span class="keyword">end</span>
0095   
0096  <span class="keyword">otherwise</span>  <span class="comment">% Both Z and M passed in</span>
0097   
0098   <span class="comment">% Not sure what the user is asking for, do something!</span>
0099   Z  = <a href="startZ.html" class="code" title="function Z = startZ(Z)">startZ</a>(varargin{1});
0100   nu = Z.nu;
0101   ny = Z.ny;
0102   
0103   <span class="comment">% Determine M based on what was passed in</span>
0104   <span class="keyword">if</span> isa(varargin{2},<span class="string">'char'</span>),
0105    M.type = varargin{2};
0106   <span class="keyword">elseif</span> isa(varargin{2},<span class="string">'struct'</span>),
0107    M  = varargin{2};
0108   <span class="keyword">elseif</span> isa(varargin{2},<span class="string">'numeric'</span>),
0109    <span class="keyword">if</span> varargin{2}&gt;=0,
0110     M.nA = varargin{2};
0111    <span class="keyword">else</span>
0112     M = struct();
0113    <span class="keyword">end</span>
0114   <span class="keyword">end</span>
0115   <span class="keyword">if</span> isfield(M,<span class="string">'nu'</span>),
0116    nu = M.nu;
0117   <span class="keyword">end</span>
0118   <span class="keyword">if</span> isfield(M,<span class="string">'ny'</span>),
0119    ny = M.ny;
0120   <span class="keyword">end</span>
0121 <span class="keyword">end</span>
0122 <span class="comment">%--------------------------------------------------------------------------</span>
0123 
0124 
0125 <span class="comment">%------------------THE DEFAULT MODEL STRUCTURE-----------------------------</span>
0126 <span class="comment">% All default values are here</span>
0127 <span class="comment">% The default model is called &quot;m&quot;</span>
0128 <span class="comment">% The default model looks like this........</span>
0129 
0130 gord    = 5;                 <span class="comment">% Default order of G dynamics</span>
0131 hord    = 2;                 <span class="comment">% Default order of H dynamics</span>
0132 m.type  = <span class="string">'arx'</span>;             <span class="comment">% Default type of model</span>
0133 
0134 <span class="comment">% Transfer function defaults</span>
0135 m.A     = [];
0136 m.B     = [];
0137 m.C     = [];
0138 m.D     = [];
0139 m.nA    = gord*ones(nu,1);  <span class="comment">% Orders for transfer function models</span>
0140 m.nB    = gord*ones(nu,1);
0141 m.nC    = hord;
0142 m.nD    = hord;
0143 
0144 <span class="comment">% State-space defaults</span>
0145 m.nx    = gord;
0146 m.estD  = 1;
0147 m.estK  = 1;
0148 m.estX1 = 1;
0149 m.estF  = 1;
0150 m.estG  = 1;
0151 m.par   = <span class="string">'ddlc'</span>;           <span class="comment">% Parametrization of model</span>
0152 
0153 <span class="comment">% Other defaults</span>
0154 m.theta   = [];
0155 m.nu      = nu;
0156 m.ny      = ny;
0157 m.finishM = <span class="string">'finishM'</span>;
0158 
0159 <span class="comment">% If a sample time was given by the data, then use it</span>
0160 <span class="keyword">if</span> isfield(Z,<span class="string">'T'</span>),
0161  m.T       = Z.T;
0162 <span class="keyword">else</span>
0163  m.T       = 1;
0164 <span class="keyword">end</span>
0165 
0166 <span class="comment">% Default operator depends on the type of data (time domain = 'q', freq. dom. = 's')</span>
0167 <span class="keyword">if</span> isfield(Z,<span class="string">'type'</span>)
0168  <span class="keyword">switch</span> Z.type
0169   <span class="keyword">case</span> <span class="string">'frequency'</span>
0170    m.op = <span class="string">'s'</span>;
0171   <span class="keyword">otherwise</span>
0172    m.op = <span class="string">'q'</span>;
0173 <span class="comment">%   if isfield(Z,'t')  % If timescale specified - could be irregular sampling</span>
0174 <span class="comment">%    if (max( diff(Z.t))-min(diff(Z.t) )&gt;1e-10)  % Is it irregular?</span>
0175 <span class="comment">%     m.op = 's';  % Yes, irregular samples, must use continuous time model</span>
0176 <span class="comment">%    end;</span>
0177 <span class="comment">%   end;</span>
0178  <span class="keyword">end</span>
0179 <span class="keyword">else</span>
0180   m.op = <span class="string">'q'</span>;
0181 <span class="keyword">end</span>
0182 
0183 <span class="comment">% If the data has an omega, then use it</span>
0184 <span class="keyword">if</span> isfield(Z,<span class="string">'w'</span>),
0185  m.w = Z.w;
0186 <span class="keyword">else</span>
0187 <span class="comment">% if strcmp(m.op,'q')</span>
0188 <span class="comment">%  m.w = logspace(log10(pi/m.T/1000),log10(pi/m.T),1000);  % Frequency samples in normalised form</span>
0189 <span class="comment">% elseif strcmp(m.op,'s')</span>
0190 <span class="comment">%  m.w = logspace(-1,2,1000);  % Good grief! Continous time and not specified by user? Could be anything - make a wild guess</span>
0191 <span class="comment">% end;</span>
0192  m.w = logspace(log10(pi/m.T/1000),log10(pi/m.T),1000);  <span class="comment">% Frequency samples in normalised form</span>
0193 <span class="keyword">end</span>;
0194 m.delay   = zeros(max(nu,1),1);
0195 
0196 <span class="comment">%--------------------------------------------------------------------------</span>
0197 
0198 <span class="comment">%----------------------WHAT IS THE MODEL TYPE?-------------------------</span>
0199 <span class="comment">% If type not specified then guess it</span>
0200 <span class="keyword">if</span> ~isfield(M,<span class="string">'type'</span>),
0201  
0202  <span class="comment">% Determine what the user has supplied in terms of poly's, orders and</span>
0203  <span class="comment">% state-space matrices</span>
0204  isApoly = isfield(M,<span class="string">'A'</span>) || isfield(M,<span class="string">'nA'</span>);
0205  isBpoly = isfield(M,<span class="string">'B'</span>) || isfield(M,<span class="string">'nB'</span>);
0206  isCpoly = isfield(M,<span class="string">'C'</span>) || isfield(M,<span class="string">'nC'</span>);
0207  isDpoly = isfield(M,<span class="string">'D'</span>) || isfield(M,<span class="string">'nD'</span>);
0208  <span class="keyword">if</span> isfield(M,<span class="string">'ss'</span>),
0209   isAss = isfield(M.ss,<span class="string">'A'</span>);
0210   isBss = isfield(M.ss,<span class="string">'B'</span>);
0211   isCss = isfield(M.ss,<span class="string">'C'</span>);
0212  <span class="keyword">else</span>
0213   isAss = 0;
0214   isBss = 0;
0215   isCss = 0;
0216  <span class="keyword">end</span>
0217  
0218  <span class="comment">% Based on supplied orders and/or poly's, then try and guess type</span>
0219  <span class="keyword">if</span> nu==0,
0220   <span class="keyword">if</span>  isApoly &amp;&amp; ~isBpoly &amp;&amp; ~isCpoly &amp;&amp; ~isDpoly, M.type=<span class="string">'ar'</span>;    <span class="keyword">end</span>
0221   <span class="keyword">if</span>  isApoly &amp;&amp; ~isBpoly &amp;&amp;  isCpoly &amp;&amp; ~isDpoly, M.type=<span class="string">'arma'</span>;  <span class="keyword">end</span>
0222  <span class="keyword">end</span>
0223  <span class="keyword">if</span> ~isApoly &amp;&amp;  isBpoly &amp;&amp; ~isCpoly &amp;&amp; ~isDpoly, M.type=<span class="string">'fir'</span>;   <span class="keyword">end</span>
0224  <span class="keyword">if</span>  isApoly &amp;&amp;  isBpoly &amp;&amp; ~isCpoly &amp;&amp; ~isDpoly, M.type=<span class="string">'arx'</span>;   <span class="keyword">end</span>
0225  <span class="keyword">if</span>  isApoly &amp;&amp;  isBpoly &amp;&amp;  isCpoly &amp;&amp; ~isDpoly, M.type=<span class="string">'armax'</span>; <span class="keyword">end</span>
0226  <span class="keyword">if</span>  isApoly &amp;&amp;  isBpoly &amp;&amp; ~isCpoly &amp;&amp; ~isDpoly, M.type=<span class="string">'oe'</span>;    <span class="keyword">end</span>
0227  <span class="keyword">if</span>  isApoly &amp;&amp;  isBpoly &amp;&amp;  isCpoly &amp;&amp;  isDpoly, M.type=<span class="string">'bj'</span>;    <span class="keyword">end</span>
0228  <span class="comment">%If a D order or poly is given, then must be BJ form</span>
0229  <span class="keyword">if</span>  isDpoly                                    , M.type=<span class="string">'bj'</span>;    <span class="keyword">end</span>
0230  <span class="comment">%If missing any poly information, then look to a SS type</span>
0231  <span class="keyword">if</span> ~isApoly &amp;&amp; ~isBpoly &amp;&amp; ~isCpoly &amp;&amp; ~isDpoly,
0232   <span class="keyword">if</span> isAss || isBss || isCss, M.type=<span class="string">'ss'</span>; <span class="keyword">end</span>
0233  <span class="keyword">end</span>
0234  
0235  <span class="comment">%If there are multiple outputs, then default to state-space model</span>
0236  <span class="keyword">if</span> ny&gt;1,
0237   M.type=<span class="string">'ss'</span>;
0238  <span class="keyword">end</span>
0239  
0240  <span class="comment">%Fill in default type if not yet specified</span>
0241  <span class="keyword">if</span> ~isfield(M,<span class="string">'type'</span>),
0242   M.type = m.type;
0243  <span class="keyword">end</span>
0244 <span class="keyword">end</span>
0245 <span class="comment">%--------------------------------------------------------------------------</span>
0246 
0247 
0248 <span class="comment">%--------------------------FILL IN DEFAULTS--------------------------------</span>
0249 <span class="comment">% Do this depending on the model type.  The reader might expect this to</span>
0250 <span class="comment">% be done by a case/switch statement - but for cts time tf we need to</span>
0251 <span class="comment">% change type to ss, and then execute that initial bit - and matlab</span>
0252 <span class="comment">% case/switch does not have C-like &quot;fall through&quot; behaviour.</span>
0253 
0254 <span class="comment">%----------------------- AR -------------------------------------------</span>
0255 
0256  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'ar'</span>,<span class="string">'nar'</span>}))
0257   <span class="comment">% Has the user specified an order for the A polynomial?</span>
0258   <span class="keyword">if</span> ~isfield(M,<span class="string">'nA'</span>),
0259    <span class="keyword">if</span> ~isfield(M,<span class="string">'A'</span>),
0260     M.nA = gord*ones(ny);
0261    <span class="keyword">else</span>
0262     <span class="keyword">if</span> floor(M.A)==M.A,
0263      M.nA = M.A;
0264     <span class="keyword">else</span>
0265      M.nA = length(M.A)-1;
0266     <span class="keyword">end</span>
0267    <span class="keyword">end</span>
0268   <span class="keyword">end</span>
0269   
0270   <span class="comment">% Make sure that the nA and A variables have only one entry</span>
0271   M.nA = M.nA(1);
0272   <span class="keyword">if</span> isfield(M,<span class="string">'A'</span>),
0273    <span class="keyword">if</span> ~isempty(M.A),
0274     M.A  = M.A(1,:);
0275    <span class="keyword">end</span>
0276   <span class="keyword">end</span>
0277   M.B  = 0.0;
0278   M.C  = 1.0;
0279   M.D  = 1.0;
0280   
0281   <span class="comment">% Set default orders for B, C and D poly's</span>
0282   M.nB = 0;
0283   M.nC = 0;
0284   M.nD = 0;
0285   
0286   <span class="comment">% Make sure the number of inputs == 0</span>
0287   M.nu = 0;
0288   M.ny = 1;
0289  <span class="keyword">end</span>;  
0290 
0291  <span class="comment">%----------------------------------------------------------------------</span>
0292   
0293  <span class="comment">%----------------------- ARMA -----------------------------------------</span>
0294  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'arma'</span>,<span class="string">'narma'</span>}))
0295   <span class="comment">% Has the user specified an order for the A polynomial?</span>
0296   <span class="keyword">if</span> ~isfield(M,<span class="string">'nA'</span>),
0297    <span class="keyword">if</span> ~isfield(M,<span class="string">'A'</span>),
0298     M.nA = gord;
0299    <span class="keyword">else</span>
0300     <span class="keyword">if</span> floor(M.A)==M.A,
0301      M.nA = M.A;
0302     <span class="keyword">else</span>
0303      M.nA = length(M.A)-1;
0304     <span class="keyword">end</span>
0305    <span class="keyword">end</span>
0306   <span class="keyword">end</span>
0307   <span class="comment">% Has the user specified an order for the C polynomial?</span>
0308   <span class="keyword">if</span> ~isfield(M,<span class="string">'nC'</span>),
0309    <span class="keyword">if</span> ~isfield(M,<span class="string">'C'</span>),
0310     M.nC = M.nA;
0311    <span class="keyword">else</span>
0312     <span class="keyword">if</span> [floor(M.C)==M.C,length(M.C)&lt;2]
0313      M.nC = M.C;
0314     <span class="keyword">else</span>
0315      M.nC = length(M.C)-1;
0316     <span class="keyword">end</span>
0317    <span class="keyword">end</span>
0318   <span class="keyword">end</span>
0319   
0320   <span class="comment">% Make sure that the nA, nC and A,C variables have only one entry</span>
0321   M.nA = M.nA(1);
0322   <span class="keyword">if</span> isfield(M,<span class="string">'A'</span>),
0323    <span class="keyword">if</span> ~isempty(M.A),
0324     M.A  = M.A(1,:);
0325    <span class="keyword">end</span>
0326   <span class="keyword">end</span>
0327   M.nC = M.nC(1);
0328   <span class="keyword">if</span> isfield(M,<span class="string">'C'</span>),
0329    <span class="keyword">if</span> ~isempty(M.C),
0330     M.C  = M.C(1,:);
0331    <span class="keyword">end</span>
0332   <span class="keyword">end</span>
0333   M.B  = 0.0;
0334   M.D  = 1.0;
0335   
0336   <span class="comment">% Set default orders for B and D poly's</span>
0337   M.nB = 0;
0338   M.nD = 0;
0339   
0340   <span class="comment">% Make sure the number of inputs == 0</span>
0341   M.nu = 0;
0342   M.ny = 1;
0343  <span class="keyword">end</span>;  
0344  <span class="comment">%----------------------------------------------------------------------</span>
0345   
0346 
0347  <span class="comment">%----------------------- FIR ------------------------------------------</span>
0348  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'fir'</span>,<span class="string">'nfir'</span>}))
0349   <span class="comment">%This may also include generalised FIR models for onid</span>
0350   <span class="comment">%Has the user specified an order for the B polynomial?</span>
0351   <span class="keyword">if</span> ~isfield(M,<span class="string">'nB'</span>),
0352    <span class="keyword">if</span> ~isfield(M,<span class="string">'B'</span>),
0353     M.nB = gord*ones(nu,1);
0354     M.nA = 0*ones(nu,1);
0355    <span class="keyword">else</span>
0356     <span class="keyword">for</span> i=1:nu,
0357      <span class="keyword">if</span> floor(M.B)==M.B,
0358       M.nB(i,1) = M.B(i);
0359       M.nA      = 0*ones(nu,1);
0360      <span class="keyword">else</span>
0361       M.nB(i,1) = length(M.B(i,:))-1;
0362       M.nA      = 0*ones(nu,1);
0363      <span class="keyword">end</span>
0364     <span class="keyword">end</span>
0365    <span class="keyword">end</span>
0366   <span class="keyword">end</span>
0367   <span class="comment">%If length(M.nB)~=number of inputs, then extend it so that it does</span>
0368   <span class="keyword">if</span> length(M.nB)&lt;nu,
0369    df = nu-length(M.nB);
0370    M.nB = [M.nB(:) ; M.nB(end)*ones(1,df)];
0371   <span class="keyword">else</span>
0372    M.nu = length(M.nB);
0373   <span class="keyword">end</span>
0374   <span class="comment">%If length(M.nA)~=number of inputs, then extend it so that it does</span>
0375   M.nA = 0;
0376   <span class="keyword">if</span> length(M.nA)~=nu,
0377    df = nu-length(M.nA);
0378    <span class="keyword">if</span> df&gt;0,
0379     M.nA = [M.nA(:) ; M.nA(end)*ones(1,df)];
0380    <span class="keyword">else</span>
0381     M.nA = M.nA(1:end-df);
0382    <span class="keyword">end</span>
0383   <span class="keyword">end</span>
0384   M.nC = 0;
0385   M.nD = 0;
0386   <span class="keyword">if</span> ~isfield(M,<span class="string">'poles'</span>),
0387    M.poles = zeros(1,max(M.nB)); <span class="comment">%Special case of FIR from onid.m</span>
0388   <span class="keyword">end</span>
0389   
0390   <span class="comment">%Set all remaining polynomials to default values</span>
0391   <span class="keyword">if</span> ~isfield(M,<span class="string">'A'</span>), M.A = ones(nu,1); <span class="keyword">end</span>
0392   M.C = 1.0;
0393   M.D = 1.0;
0394  <span class="keyword">end</span>;
0395  <span class="comment">%----------------------------------------------------------------------</span>
0396   
0397  <span class="comment">%----------------------- ARX ------------------------------------------</span>
0398  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'arx'</span>,<span class="string">'narx'</span>}))
0399   <span class="comment">%Has the user specified an order for the A polynomial?</span>
0400   <span class="keyword">if</span> ~isfield(M,<span class="string">'nA'</span>),
0401    <span class="keyword">if</span> ~isfield(M,<span class="string">'A'</span>),
0402     M.nA = gord;
0403    <span class="keyword">elseif</span> isempty(M.A),
0404     M.nA = gord;
0405    <span class="keyword">else</span>
0406     <span class="keyword">if</span> floor(M.A)==M.A,
0407      M.nA = M.A;
0408     <span class="keyword">else</span>
0409      M.nA = length(M.A)-1;
0410     <span class="keyword">end</span>
0411    <span class="keyword">end</span>
0412   <span class="keyword">end</span>
0413   <span class="comment">%Has the user specified an order for the B polynomial?</span>
0414   <span class="keyword">if</span> ~isfield(M,<span class="string">'nB'</span>),
0415    <span class="keyword">if</span> ~isfield(M,<span class="string">'B'</span>),
0416     M.nB = M.nA;
0417    <span class="keyword">elseif</span> isempty(M.B),
0418     M.nB = M.nA;
0419    <span class="keyword">else</span>
0420     <span class="keyword">if</span> floor(M.B)==M.B,
0421      M.nB = M.B;
0422     <span class="keyword">else</span>
0423      <span class="keyword">for</span> i=1:nu,
0424       M.nB = length(M.B)-1;
0425      <span class="keyword">end</span>
0426     <span class="keyword">end</span>
0427    <span class="keyword">end</span>
0428   <span class="keyword">end</span>
0429   <span class="comment">%If length(M.nB)~=number of inputs, then extend it so that it does</span>
0430   <span class="keyword">if</span> length(M.nB)&lt;nu,
0431    df = nu-length(M.nB);
0432    M.nB = [M.nB(:) ; M.nB(end)*ones(1,df)];
0433   <span class="keyword">else</span>
0434    M.nu = length(M.nB);
0435   <span class="keyword">end</span>
0436   
0437   <span class="comment">%Make sure that the nA and A variables have only one entry</span>
0438   M.nA = M.nA(1);
0439   <span class="keyword">if</span> isfield(M,<span class="string">'A'</span>),
0440    <span class="keyword">if</span> ~isempty(M.A),
0441     M.A  = M.A(1,:);
0442    <span class="keyword">end</span>
0443   <span class="keyword">end</span>
0444   M.C  = 1.0;
0445   M.D  = 1.0;
0446   
0447   <span class="comment">%Set default orders for C and D poly's</span>
0448   M.nC = 0;
0449   M.nD = 0;
0450  <span class="keyword">end</span>;
0451  <span class="comment">%----------------------------------------------------------------------</span>
0452   
0453  <span class="comment">%----------------------- ARMAX ----------------------------------------</span>
0454  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'armax'</span>,<span class="string">'narmax'</span>}))
0455   <span class="comment">%Has the user specified an order for the A polynomial?</span>
0456   <span class="keyword">if</span> ~isfield(M,<span class="string">'nA'</span>),
0457    <span class="keyword">if</span> ~isfield(M,<span class="string">'A'</span>),
0458     M.nA = gord;
0459    <span class="keyword">else</span>
0460     <span class="keyword">if</span> floor(M.A)==M.A,
0461      M.nA = M.A;
0462     <span class="keyword">else</span>
0463      M.nA = length(M.A)-1;
0464     <span class="keyword">end</span>
0465    <span class="keyword">end</span>
0466   <span class="keyword">end</span>
0467   <span class="comment">%Has the user specified an order for the B polynomial?</span>
0468   <span class="keyword">if</span> ~isfield(M,<span class="string">'nB'</span>),
0469    <span class="keyword">if</span> ~isfield(M,<span class="string">'B'</span>),
0470     M.nB = M.nA;
0471    <span class="keyword">else</span>
0472     <span class="keyword">for</span> i=1:nu,
0473      <span class="keyword">if</span> floor(M.B)==M.B,
0474       M.nB(i,1) = M.B(i);
0475      <span class="keyword">else</span>
0476       M.nB(i,1) = length(M.B(i,:))-1;
0477      <span class="keyword">end</span>
0478     <span class="keyword">end</span>
0479    <span class="keyword">end</span>
0480   <span class="keyword">end</span>
0481   <span class="comment">%Has the user specified an order for the C polynomial?</span>
0482   <span class="keyword">if</span> ~isfield(M,<span class="string">'nC'</span>),
0483    <span class="keyword">if</span> ~isfield(M,<span class="string">'C'</span>),
0484     M.nC = hord;
0485    <span class="keyword">else</span>
0486     <span class="keyword">if</span> floor(M.C)==M.C,
0487      M.nC = M.C;
0488     <span class="keyword">else</span>
0489      M.nC = length(M.C)-1;
0490     <span class="keyword">end</span>
0491    <span class="keyword">end</span>
0492   <span class="keyword">end</span>
0493   <span class="comment">%If length(M.nB)~=number of inputs, then extend it so that it does</span>
0494   <span class="keyword">if</span> length(M.nB)&lt;nu,
0495    df = nu-length(M.nB);
0496    M.nB = [M.nB(:) ; M.nB(end)*ones(1,df)];
0497   <span class="keyword">else</span>
0498    M.nu = length(M.nB);
0499   <span class="keyword">end</span>
0500   
0501   <span class="comment">%Make sure that the nA and A variables have only one entry</span>
0502   M.nA = M.nA(1);
0503   <span class="keyword">if</span> isfield(M,<span class="string">'A'</span>),
0504    <span class="keyword">if</span> ~isempty(M.A),
0505     M.A  = M.A(1,:);
0506    <span class="keyword">end</span>
0507   <span class="keyword">end</span>
0508   M.D  = 1.0;
0509   
0510   <span class="comment">%Set default order for D poly</span>
0511   M.nD = 0;
0512  <span class="keyword">end</span>;
0513  <span class="comment">%----------------------------------------------------------------------</span>
0514   
0515  <span class="comment">%----------------------- OE -------------------------------------------</span>
0516  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'oe'</span>,<span class="string">'noe'</span>}))
0517   <span class="comment">% Has the user specified an order for the A polynomial?</span>
0518   <span class="keyword">if</span> ~isfield(M,<span class="string">'nA'</span>),
0519    <span class="keyword">if</span> ~isfield(M,<span class="string">'A'</span>),
0520     M.nA = gord;
0521    <span class="keyword">else</span>
0522     <span class="comment">% Loop over each input to guess order</span>
0523     <span class="keyword">for</span> i=1:nu,
0524      <span class="keyword">if</span> floor(M.A)==M.A,
0525       M.nA(i,1) = M.A(i);
0526      <span class="keyword">else</span>
0527       M.nA(i,1) = length(M.A(i,:))-1;
0528      <span class="keyword">end</span>
0529     <span class="keyword">end</span>
0530    <span class="keyword">end</span>
0531   <span class="keyword">end</span>
0532   <span class="comment">% Has the user specified an order for the B polynomial?</span>
0533   <span class="keyword">if</span> ~isfield(M,<span class="string">'nB'</span>),
0534    <span class="keyword">if</span> ~isfield(M,<span class="string">'B'</span>),
0535     M.nB = M.nA;
0536    <span class="keyword">else</span>
0537     <span class="comment">% Loop over each input to guess order</span>
0538     <span class="keyword">for</span> i=1:nu,
0539      <span class="keyword">if</span> floor(M.B)==M.B,
0540       M.nB(i,1) = M.B(i);
0541      <span class="keyword">else</span>
0542       M.nB(i,1) = length(M.B(i,:))-1;
0543      <span class="keyword">end</span>
0544     <span class="keyword">end</span>
0545    <span class="keyword">end</span>
0546   <span class="keyword">end</span>
0547   <span class="comment">% If length(M.nA)~=number of inputs, then extend it so that it does</span>
0548   <span class="keyword">if</span> length(M.nA)&lt;nu,
0549    df = nu-length(M.nA);
0550    M.nA = [M.nA(:) ; M.nA(end)*ones(1,df)];
0551   <span class="keyword">else</span>
0552    M.nu = length(M.nA);
0553   <span class="keyword">end</span>
0554   <span class="comment">% If length(M.nB)~=number of inputs, then extend it so that it does</span>
0555   <span class="keyword">if</span> length(M.nB)&lt;nu,
0556    df = nu-length(M.nB);
0557    M.nB = [M.nB(:) ; M.nB(end)*ones(1,df)];
0558   <span class="keyword">else</span>
0559    M.nu = length(M.nB);
0560   <span class="keyword">end</span>
0561   
0562   <span class="comment">% Set default orders for C and D poly's</span>
0563   M.nC = 0;
0564   M.nD = 0;
0565   M.C  = 1.0;
0566   M.D  = 1.0;
0567  <span class="keyword">end</span>; 
0568  <span class="comment">%----------------------------------------------------------------------</span>
0569   
0570  <span class="comment">%----------------------- BJ -------------------------------------------</span>
0571  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'bj'</span>,<span class="string">'nbj'</span>}))
0572   <span class="comment">% Has the user specified an order for the A polynomial?</span>
0573   <span class="keyword">if</span> ~isfield(M,<span class="string">'nA'</span>),
0574    <span class="keyword">if</span> ~isfield(M,<span class="string">'A'</span>),
0575     M.nA = gord;
0576    <span class="keyword">else</span>
0577     <span class="comment">% Loop over each input to guess order</span>
0578     <span class="keyword">for</span> i=1:size(M.A,1),
0579      <span class="keyword">if</span> floor(M.A)==M.A,
0580       M.nA(i,1) = M.A(i);
0581      <span class="keyword">else</span>
0582       M.nA(i,1) = length(M.A(i,:))-1;
0583      <span class="keyword">end</span>
0584     <span class="keyword">end</span>
0585    <span class="keyword">end</span>
0586   <span class="keyword">end</span>
0587   <span class="comment">% Has the user specified an order for the B polynomial?</span>
0588   <span class="keyword">if</span> ~isfield(M,<span class="string">'nB'</span>),
0589    <span class="keyword">if</span> ~isfield(M,<span class="string">'B'</span>),
0590     M.nB = M.nA;
0591    <span class="keyword">else</span>
0592     <span class="comment">% Loop over each input to guess order</span>
0593     <span class="keyword">for</span> i=1:size(M.B,1),
0594      <span class="keyword">if</span> floor(M.B)==M.B,
0595       M.nB(i,1) = M.B(i);
0596      <span class="keyword">else</span>
0597       M.nB(i,1) = length(M.B(i,:))-1;
0598      <span class="keyword">end</span>
0599     <span class="keyword">end</span>
0600    <span class="keyword">end</span>
0601   <span class="keyword">end</span>
0602   <span class="comment">% Has the user specified an order for the C polynomial?</span>
0603   <span class="keyword">if</span> ~isfield(M,<span class="string">'nC'</span>),
0604    <span class="keyword">if</span> ~isfield(M,<span class="string">'C'</span>),
0605     <span class="keyword">if</span> isfield(M,<span class="string">'D'</span>) <span class="keyword">if</span> (floor(M.D)==M.D) hord = M.D; <span class="keyword">end</span>; <span class="keyword">end</span>;
0606     M.nC = hord;
0607    <span class="keyword">else</span>
0608     <span class="keyword">if</span> [floor(M.C)==M.C,length(M.C)&lt;2]
0609      M.nC = M.C;
0610     <span class="keyword">else</span>
0611      M.nC = length(M.C)-1;
0612     <span class="keyword">end</span>
0613    <span class="keyword">end</span>
0614   <span class="keyword">end</span>
0615   <span class="comment">% Has the user specified an order for the D polynomial?</span>
0616   <span class="keyword">if</span> ~isfield(M,<span class="string">'nD'</span>),
0617    <span class="keyword">if</span> ~isfield(M,<span class="string">'D'</span>),
0618     M.nD = M.nC;
0619    <span class="keyword">else</span>
0620     <span class="keyword">if</span> floor(M.D)==M.D,
0621      M.nD = M.D;
0622     <span class="keyword">else</span>
0623      M.nD = length(M.D)-1;
0624     <span class="keyword">end</span>
0625    <span class="keyword">end</span>
0626   <span class="keyword">end</span>
0627   <span class="comment">% If length(M.nA)~=number of inputs, then extend it so that it does</span>
0628   <span class="keyword">if</span> length(M.nA)&lt;nu,
0629    df = nu-length(M.nA);
0630    M.nA = [M.nA(:) ; M.nA(end)*ones(1,df)];
0631   <span class="keyword">else</span>
0632    M.nu = length(M.nA);
0633   <span class="keyword">end</span>
0634   <span class="comment">% If length(M.nB)~=number of inputs, then extend it so that it does</span>
0635   <span class="keyword">if</span> length(M.nB)&lt;nu,
0636    df = nu-length(M.nB);
0637    M.nB = [M.nB(:) ; M.nB(end)*ones(1,df)];
0638   <span class="keyword">else</span>
0639    M.nu = length(M.nB);
0640   <span class="keyword">end</span>
0641  <span class="keyword">end</span>; 
0642  <span class="comment">%----------------------------------------------------------------------</span>
0643   
0644   
0645  <span class="comment">%----------------------- SS -------------------------------------------</span>
0646  <span class="keyword">if</span> sum(strcmpi(M.type,{<span class="string">'ss'</span>,<span class="string">'nss'</span>,<span class="string">'bilin'</span>,<span class="string">'bilinear'</span>}))
0647   <span class="comment">% Determine state order nx</span>
0648   <span class="keyword">if</span> ~isfield(M,<span class="string">'nx'</span>),
0649    <span class="keyword">if</span> isfield(M,<span class="string">'ss'</span>),
0650     <span class="keyword">if</span> isfield(M.ss,<span class="string">'A'</span>)
0651      M.nx = size(M.ss.A,1);
0652     <span class="keyword">end</span>
0653    <span class="keyword">end</span>
0654   <span class="keyword">end</span>
0655   
0656   <span class="keyword">if</span> ~isfield(M,<span class="string">'nx'</span>),
0657    <span class="keyword">if</span> isfield(M,<span class="string">'nA'</span>),
0658     M.nx = M.nA;
0659    <span class="keyword">elseif</span> isfield(M,<span class="string">'A'</span>),
0660     <span class="keyword">if</span> floor(M.A)==M.A,
0661      M.nx = max(max(M.A));
0662     <span class="keyword">else</span>
0663      M.nx = m.nx;
0664     <span class="keyword">end</span>
0665    <span class="keyword">else</span>
0666     M.nx = m.nx;
0667    <span class="keyword">end</span>
0668   <span class="keyword">end</span>
0669   
0670   <span class="comment">% if a system has been given, then make sure nx, nu, and ny are set</span>
0671   <span class="comment">% correctly</span>
0672   <span class="keyword">if</span> isfield(M,<span class="string">'ss'</span>),
0673    <span class="keyword">if</span> isfield(M.ss,<span class="string">'A'</span>),
0674     <span class="keyword">if</span> ~isempty(M.ss.A),
0675      <span class="keyword">if</span> M.nx~=size(M.ss.A,1),
0676       M.nx = size(M.ss.A,1);
0677      <span class="keyword">end</span>
0678     <span class="keyword">end</span>
0679    <span class="keyword">end</span>
0680    <span class="keyword">if</span> isfield(M.ss,<span class="string">'B'</span>),
0681     <span class="keyword">if</span> ~isempty(M.ss.B),
0682      <span class="keyword">if</span> nu~=size(M.ss.B,2),
0683       M.nu = size(M.ss.B,2);
0684      <span class="keyword">end</span>
0685     <span class="keyword">end</span>
0686    <span class="keyword">else</span>
0687     M.nu = 0;
0688    <span class="keyword">end</span>
0689    <span class="keyword">if</span> isfield(M.ss,<span class="string">'C'</span>),
0690     <span class="keyword">if</span> ~isempty(M.ss.C),
0691      <span class="keyword">if</span> ny~=size(M.ss.C,1),
0692       M.ny = size(M.ss.C,1);
0693      <span class="keyword">end</span>
0694     <span class="keyword">end</span>
0695    <span class="keyword">else</span>
0696     M.ny = 0;
0697    <span class="keyword">end</span>
0698   <span class="keyword">end</span>
0699     
0700   <span class="comment">% Make sure that if a continuous-time model is asked for then we set</span>
0701   <span class="comment">% M.par = 'full';</span>
0702   discrete = 1;
0703   <span class="keyword">if</span> isfield(M,<span class="string">'op'</span>),
0704    <span class="keyword">if</span> strcmpi(M.op,<span class="string">'s'</span>),
0705     discrete = 0;
0706    <span class="keyword">end</span>
0707   <span class="keyword">end</span>
0708   <span class="keyword">if</span> ~isfield(M,<span class="string">'par'</span>),
0709    <span class="keyword">if</span> ~discrete,
0710     M.par = <span class="string">'full'</span>;
0711    <span class="keyword">end</span>
0712   <span class="keyword">end</span>
0713  <span class="keyword">end</span>;       
0714  <span class="comment">%----------------------------------------------------------------------</span>
0715  <span class="comment">%</span>
0716   
0717  <span class="comment">%----------------------- NONPAR ---------------------------------------</span>
0718  <span class="keyword">if</span> strcmpi(M.type,<span class="string">'nonpar'</span>) 
0719  <span class="keyword">end</span>;
0720   
0721  <span class="comment">%----------------------------------------------------------------------</span>
0722   
0723  <span class="comment">%----------------------- STATIC ---------------------------------------</span>
0724  <span class="keyword">if</span> strcmpi(M.type,<span class="string">'static'</span>)
0725   M.nA = 0;
0726   M.nB = 0;
0727   M.nC = 0;
0728   M.nD = 0;
0729   M.A  = 1.0;
0730   M.B  = 0.0;
0731   M.C  = 1.0;
0732   M.D  = 1.0;
0733  <span class="keyword">end</span>;
0734  <span class="comment">%----------------------------------------------------------------------</span>
0735   
0736  <span class="comment">%----------------------- NONLINEAR STATE-SPACE ------------------------</span>
0737  <span class="keyword">if</span> strcmpi(M.type,<span class="string">'nlss'</span>)
0738    M.op = <span class="string">'q'</span>;
0739    M.finishM = <span class="string">'nlssfinish'</span>;
0740  <span class="keyword">end</span>;       
0741         
0742 <span class="comment">%  %----------------------- DEFAULT --------------------------------------</span>
0743 <span class="comment">% otherwise</span>
0744 <span class="comment">%  M.type = m.type;</span>
0745 
0746 <span class="comment">%------------------Fill in bits of M that come from data-------------------</span>
0747 <span class="keyword">if</span> isfield(Z,<span class="string">'type'</span>),
0748  <span class="keyword">switch</span> Z.type,
0749   <span class="keyword">case</span> <span class="string">'frequency'</span>,
0750    <span class="keyword">if</span> ~isfield(M,<span class="string">'w'</span>),
0751     M.w = Z.w;
0752    <span class="keyword">end</span>
0753    <span class="keyword">if</span> isfield(M,<span class="string">'T'</span>)
0754     <span class="keyword">if</span> M.T*max(M.w)&gt;pi+1000*eps,
0755      warning(<span class="string">'M.T and Z.w are not compatible for M.op=&quot;q&quot;, resetting M.T = pi/max(M.w);'</span>)
0756      M.T = pi/max(M.w);
0757     <span class="keyword">end</span>
0758    <span class="keyword">else</span>
0759     M.T = pi/max(M.w);
0760    <span class="keyword">end</span>
0761    
0762   <span class="keyword">case</span> <span class="string">'time'</span>
0763    <span class="keyword">if</span> ~isfield(M,<span class="string">'T'</span>),
0764     M.T = Z.T;
0765    <span class="keyword">end</span>
0766    <span class="keyword">if</span> ~isfield(M,<span class="string">'w'</span>)
0767     <span class="keyword">if</span> isfield(Z,<span class="string">'w'</span>)
0768      M.w = Z.w;
0769     <span class="keyword">else</span>
0770      M.w = logspace(log10(pi/M.T)-4,log10(pi/M.T),2000);
0771     <span class="keyword">end</span>
0772    <span class="keyword">end</span>
0773  <span class="keyword">end</span>
0774 <span class="keyword">end</span>
0775 <span class="comment">%--------------------------------------------------------------------------</span>
0776 
0777 <span class="comment">%------------------Fill in missing or empty fields of M--------------------</span>
0778 
0779 <span class="keyword">if</span> ~strcmpi(M.type,<span class="string">'nlss'</span>)  <span class="comment">%If M.typeis nonlinear state-space then don't fill in defaults</span>
0780  fn=fieldnames(m);
0781  <span class="keyword">if</span> isempty(M),
0782   M=m;
0783  <span class="keyword">else</span>
0784   <span class="keyword">for</span> i=1:length(fn),
0785    <span class="keyword">if</span> ~isfield(M,fn{i}),
0786     M = setfield(M,fn{i},getfield(m,fn{i}));
0787    <span class="keyword">elseif</span> isempty(getfield(M,fn{i}))
0788     M = setfield(M,fn{i},getfield(m,fn{i}));
0789    <span class="keyword">end</span>
0790   <span class="keyword">end</span>
0791  <span class="keyword">end</span>
0792     
0793  <span class="comment">%Make sure the delays are of the correct orientation and size.</span>
0794  M.delay = M.delay(:);
0795  <span class="keyword">if</span> size(M.delay,1) ~= M.nu,
0796   M.delay = [M.delay;zeros(M.nu-size(M.delay,1),1)];
0797  <span class="keyword">end</span>
0798   
0799  <span class="comment">%Initialise Hammerstein and Wiener NL blocks</span>
0800  M = <a href="startNL.html" class="code" title="function M = startNL(Z,M)">startNL</a>(Z,M);
0801 
0802 <span class="keyword">end</span>
0803     
0804 M = orderfields(M);
0805 
0806</pre></div>
<hr><address>Generated on Sun 04-May-2025 22:15:31 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>