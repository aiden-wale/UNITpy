<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of details</title>
  <meta name="keywords" content="details">
  <meta name="description" content="DETAILS: This function summarises details about a model structure.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">unit</a> &gt; details.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for unit&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>details
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>DETAILS: This function summarises details about a model structure.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function handle = details(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> DETAILS: This function summarises details about a model structure.

 Usage is

 details(G)

 Where

 G = data structure storing an estimated model.

 Example: G = est(Z,M,OPT); details(G);

   written by Brett Ninness, School of EE &amp; CS
                             University of Newcastle
                             Australia.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="dzone.html" class="code" title="function z = dzone(u,lower,upper)">dzone</a>	Function to deadzone a signal u between a</li><li><a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>	This function does least squares fitting for FIR models based on</li><li><a href="hinge.html" class="code" title="function [x,w] = hinge(u,alpha)">hinge</a>	HINGE - function to pass a signal vector u through a nonlinearity X to</li><li><a href="m2theta.html" class="code" title="function theta = m2theta(M);">m2theta</a>	M2THETA - function to convert from model structure definition to stacked</li><li><a href="polynom.html" class="code" title="function [x,phi,w] = polynom(u,alpha)">polynom</a>	POLYNOM - function to pass a signal vector u through a nonlinearity X to</li><li><a href="sat.html" class="code" title="function z = sat(u,lower,upper,m)">sat</a>	Function to saturate a signal u in the</li><li><a href="theta2m.html" class="code" title="function [G,SD] = theta2m(theta,M,fast)">theta2m</a>	THETA2M - function to convert from stacked parameter vector to model</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function urdisp(str,guiRunning,guihandle,popup)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% DETAILS: This function summarises details about a model structure.</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% Usage is</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% details(G)</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% Where</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% G = data structure storing an estimated model.</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Example: G = est(Z,M,OPT); details(G);</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   written by Brett Ninness, School of EE &amp; CS</span>
0014 <span class="comment">%                             University of Newcastle</span>
0015 <span class="comment">%                             Australia.</span>
0016 
0017 <span class="comment">% Copyright (C) Brett Ninness.</span>
0018 
0019 <a name="_sub0" href="#_subfunctions" class="code">function handle = details(varargin)</a>
0020 
0021 <span class="comment">%Set empty variable that will contain handles to figures</span>
0022 handle = [];
0023 popup  = [];
0024 
0025 lg=length(varargin);
0026 <span class="keyword">if</span> lg&lt;1, error(<span class="string">'Need at least one input argument'</span>); <span class="keyword">end</span>
0027 G=varargin{1};
0028 <span class="keyword">if</span> nargin&gt;1,
0029  popup = varargin{2};
0030 <span class="keyword">end</span>
0031 
0032 <span class="comment">%Detect if gui is running</span>
0033 gui = 0;
0034 guih = [];
0035 <span class="keyword">if</span> isfield(G,<span class="string">'OPT'</span>)   <span class="comment">% Hack by Brett - should really fix other routines so G.OPT is always put in</span>
0036  <span class="keyword">if</span> isfield(G.OPT,<span class="string">'gui'</span>),
0037   <span class="keyword">if</span> ~isempty(G.OPT.gui)
0038    gui  = 1;           <span class="comment">%GUI is running</span>
0039    guih = G.OPT.gui;   <span class="comment">%GUI handle</span>
0040   <span class="keyword">end</span>
0041  <span class="keyword">end</span>
0042 <span class="keyword">else</span>
0043  gui=0;
0044 <span class="keyword">end</span>
0045 
0046 urline = <span class="string">'----------------------------------------------------------------------'</span>;
0047 <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0048 
0049 <span class="keyword">switch</span> G.type
0050  
0051  <span class="comment">%----------------------------------------------------------------------</span>
0052  <span class="comment">%                                NONPAR</span>
0053  <span class="comment">%----------------------------------------------------------------------</span>
0054  <span class="keyword">case</span> <span class="string">'nonpar'</span>
0055   <span class="comment">%Try a quick return if NONPAR</span>
0056   <span class="keyword">if</span> strcmpi(G.type,<span class="string">'nonpar'</span>),
0057    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0058    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Details for Estimated Model Structure'</span>],gui,guih,popup);
0059    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0060    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = Non Parametric'</span>],gui,guih,popup)
0061    <span class="keyword">if</span> strcmpi(G.alg,<span class="string">'ETFE'</span>)
0062     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = ETFE'</span>],gui,guih,popup)
0063    <span class="keyword">else</span>
0064     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Blackman-Tukey'</span>],gui,guih,popup)
0065    <span class="keyword">end</span>
0066    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'Data length (samples)          = %i'</span>,G.Ny),gui,guih,popup)
0067    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'Window used                    = %s'</span>,G.OPT.window),gui,guih,popup)
0068    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'Window length (samples)        = %i  (%3.1f%%)'</span>,G.OPT.N,100*G.OPT.N/G.Ny),gui,guih,popup)
0069    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup)
0070    <span class="keyword">return</span>;
0071   <span class="keyword">end</span>
0072   
0073   
0074   <span class="comment">%----------------------------------------------------------------------</span>
0075   <span class="comment">%                      TRANSFER FUNCTION MODELS</span>
0076   <span class="comment">%----------------------------------------------------------------------</span>
0077  <span class="keyword">case</span> {<span class="string">'ar'</span>,<span class="string">'arma'</span>,<span class="string">'fir'</span>,<span class="string">'arx'</span>,<span class="string">'armax'</span>,<span class="string">'oe'</span>,<span class="string">'bj'</span>}
0078   
0079   <span class="keyword">if</span> ~isfield(G,<span class="string">'var'</span>)
0080    error(<span class="string">'This function is to be used with estimated models, not just structure specifications!'</span>)
0081   <span class="keyword">else</span>  <span class="comment">% Otherwise, get standard deviations on estimated parameters</span>
0082    <span class="comment">% Need to discriminate several times on type - streamline the syntax</span>
0083    <span class="keyword">if</span> strcmpi(G.type,<span class="string">'armax'</span>) armax=1; <span class="keyword">else</span> armax=0; <span class="keyword">end</span>;
0084    <span class="keyword">if</span> strcmpi(G.type,<span class="string">'fir'</span>)   <a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>=1;   <span class="keyword">else</span> <a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>=0;   <span class="keyword">end</span>;
0085    
0086    <span class="comment">% Need to handle fir/arx as specials since latter hand back theta/SD with no nonlin parts</span>
0087    <span class="comment">% Are there any non-linear parts on inputs?</span>
0088    inlin=1;
0089    <span class="keyword">for</span> k=1:length(G.in)
0090     <span class="keyword">if</span> ~strcmp(lower(G.in(k).type),<span class="string">'linear'</span>) inlin=0; <span class="keyword">end</span>
0091    <span class="keyword">end</span>
0092    <span class="keyword">if</span> any(strcmpi(G.type,{<span class="string">'arx'</span>,<span class="string">'farx'</span>,<span class="string">'fir'</span>}))
0093     SD = G.SD; <span class="comment">% SD's of linear parameter parts</span>
0094     <span class="keyword">if</span> ~inlin
0095      th  = <a href="m2theta.html" class="code" title="function theta = m2theta(M);">m2theta</a>(G);
0096      g   = G;
0097      g.P = g.P(end-length(th)+1:<span class="keyword">end</span>,end-length(th)+1:end);
0098      [dummy,sd] = <a href="theta2m.html" class="code" title="function [G,SD] = theta2m(theta,M,fast)">theta2m</a>(th,g);
0099      SD.in = sd.in;
0100     <span class="keyword">end</span>
0101     <span class="keyword">if</span> ~strcmpi(G.out.type,<span class="string">'linear'</span>)
0102      th  = <a href="m2theta.html" class="code" title="function theta = m2theta(M);">m2theta</a>(G);
0103      g   = G;
0104      g.P = g.P(end-length(th)+1:<span class="keyword">end</span>,end-length(th)+1:end);
0105      [dummy,sd] = <a href="theta2m.html" class="code" title="function [G,SD] = theta2m(theta,M,fast)">theta2m</a>(th,g);
0106      SD.out = sd.out;
0107     <span class="keyword">end</span>
0108    <span class="keyword">else</span> <span class="comment">% Otherwise, all parameters found iteratively, so theta2m extracts all SD's</span>
0109     [dummy,SD] = <a href="theta2m.html" class="code" title="function [G,SD] = theta2m(theta,M,fast)">theta2m</a>(G.theta,G);
0110    <span class="keyword">end</span>
0111   <span class="keyword">end</span>
0112   
0113   <span class="keyword">if</span> ~isfield(G,<span class="string">'type'</span>),
0114    G.type = <span class="string">'not specified'</span>;
0115   <span class="keyword">end</span>
0116   
0117   [nu,dummy,ny] = size(G.A);  <span class="comment">% How many dynamics models to print out?</span>
0118   
0119   <span class="comment">%  Print out the details of the linear part of the model structure:</span>
0120   
0121   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0122   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Details for Estimated Model Structure'</span>],gui,guih,popup);
0123   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0124   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Operator used in model         = '</span>,G.op],gui,guih,popup)
0125   <span class="keyword">if</span> G.T&gt;0,
0126    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Sampling Period                = '</span>,sprintf(<span class="string">'%f '</span>,G.T),<span class="string">'seconds'</span>],gui,guih,popup)
0127   <span class="keyword">else</span>
0128    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Sampling Period                = irregular'</span>],gui,guih,popup)
0129   <span class="keyword">end</span>
0130   <span class="keyword">if</span> G.T&gt;0,
0131    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimated Innovations Variance = '</span>,sprintf(<span class="string">'%e '</span>,trace(G.var))],gui,guih,popup)
0132   <span class="keyword">else</span>
0133    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimated Innovations Variance = '</span>,sprintf(<span class="string">'%e '</span>,trace(G.ss.R))],gui,guih,popup)
0134   <span class="keyword">end</span>
0135   <span class="keyword">switch</span> lower(G.type),
0136    <span class="keyword">case</span> {<span class="string">'fir'</span>,<span class="string">'nfir'</span>}
0137     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = FIR'</span>],gui,guih,popup)
0138    <span class="keyword">case</span> {<span class="string">'arx'</span>,<span class="string">'narx'</span>}
0139     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = ARX'</span>],gui,guih,popup);
0140    <span class="keyword">case</span> {<span class="string">'bj'</span>,<span class="string">'nbj'</span>}
0141     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = Box-Jenkins'</span>],gui,guih,popup)
0142    <span class="keyword">case</span> {<span class="string">'arma'</span>,<span class="string">'narma'</span>}
0143     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = ARMA'</span>],gui,guih,popup)
0144    <span class="keyword">case</span> {<span class="string">'armax'</span>,<span class="string">'narmax'</span>}
0145     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = ARMAX'</span>],gui,guih,popup)
0146    <span class="keyword">case</span> {<span class="string">'oe'</span>,<span class="string">'noe'</span>}
0147     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = Output Error'</span>],gui,guih,popup)
0148    <span class="keyword">otherwise</span>
0149     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = Not Specified'</span>],gui,guih,popup)
0150   <span class="keyword">end</span>
0151   
0152   <span class="keyword">if</span> strcmpi(G.alg,<span class="string">'block'</span>)
0153    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Block solution'</span>],gui,guih,popup)
0154   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'gn'</span>)
0155    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Gauss-Newton search'</span>],gui,guih,popup);
0156   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'em'</span>)
0157    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Expect-Maxim (EM) search'</span>],gui,guih,popup)
0158   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'sid'</span>)
0159    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = N4SID Subspace Regression'</span>],gui,guih,popup)
0160   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'cca'</span>)
0161    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Canonical Correlation Analysis'</span>],gui,guih,popup)
0162   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'n4sid'</span>)
0163    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = N4SID Subspace Regression'</span>],gui,guih,popup)
0164   <span class="keyword">else</span>
0165    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Not Specified'</span>],gui,guih,popup)
0166   <span class="keyword">end</span>;
0167   
0168   <span class="comment">% Print out details for non-linear part of model structure</span>
0169   <span class="keyword">if</span> G.nu&gt;0  <span class="comment">% Only if there is an input</span>
0170    <span class="keyword">for</span> k=1:nu
0171     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([sprintf(<span class="string">'Input #%d block type            = '</span>,k),G.in(k).type],gui,guih,popup)
0172    <span class="keyword">end</span>;
0173    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Output block type              = '</span>,G.out.type],gui,guih,popup)
0174    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup)
0175   <span class="keyword">end</span>;
0176   
0177   <span class="comment">%Print the model equations</span>
0178   <span class="keyword">if</span> isfield(G,<span class="string">'modelEquations'</span>),
0179    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'\nModel Equations are:'</span>),gui,guih,popup)
0180    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(G.modelEquations,gui,guih,popup)
0181   <span class="keyword">end</span>
0182   
0183   <span class="keyword">if</span> ny*nu &lt; 20  <span class="comment">% Don't print out a ridiculous number of transfer functions</span>
0184    <span class="keyword">for</span> m=1:ny  <span class="comment">% Loop over all outputs</span>
0185     <span class="keyword">for</span> k=1:nu  <span class="comment">% Loop over all inputs</span>
0186      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup)
0187 <span class="comment">%      if fir</span>
0188 <span class="comment">%       urdisp(urline,gui,guih,popup);</span>
0189 <span class="comment">%       urdisp(['Estimated (generalised) FIR parameters &amp; standard deviations:'],gui,guih,popup);</span>
0190 <span class="comment">%       urdisp(urline,gui,guih,popup);</span>
0191 <span class="comment">%       th='TH= ';sd='SD= ';</span>
0192 <span class="comment">%       for r=1:length(G.TH(:,k));</span>
0193 <span class="comment">%        %  theta = [G.TH(:,k)';SD.th(:,k)']</span>
0194 <span class="comment">%        if (G.TH(r,k)&lt;0) sp1=''; else sp1=' '; end;</span>
0195 <span class="comment">%        th = [th,sp1,sprintf('%0.4f ',G.TH(r,k))];</span>
0196 <span class="comment">%        sd = [sd,sprintf(' %0.4f ',SD.th(r,k))];</span>
0197 <span class="comment">%       end;</span>
0198 <span class="comment">%       urdisp(th,gui,guih,popup); urdisp(sd,gui,guih,popup); urdisp(' ',gui,guih,popup);</span>
0199 <span class="comment">%      end;</span>
0200      
0201      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0202      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'Input #%d to Output #%d Estimated T/F model + standard devs: '</span>,k,m),gui,guih,popup);
0203      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0204      
0205      <span class="keyword">if</span> strcmpi(G.type,<span class="string">'arma'</span>),
0206       B1=[    ]; B2=<span class="string">'C = '</span>;B3=<span class="string">'SD= '</span>;
0207       SD.C = [0 SD.C];
0208       <span class="keyword">for</span> r=1:G.nC(k)+1
0209        <span class="keyword">if</span> r&gt;1
0210         B1 = [B1,[<span class="string">' '</span>,G.op,<span class="string">'^-'</span>,int2str(r-1),<span class="string">'   '</span>]];
0211        <span class="keyword">else</span>
0212         B1 = [B1,[<span class="string">'     1   '</span>,<span class="string">'   '</span>]];
0213        <span class="keyword">end</span>;
0214        <span class="keyword">if</span> (G.C(r)&lt;0) sp1=<span class="string">''</span>; <span class="keyword">else</span> sp1=<span class="string">' '</span>; <span class="keyword">end</span>;
0215        B2 = [B2,sp1,sprintf(<span class="string">'%0.4f '</span>,G.C(r))];
0216        B3 = [B3,sprintf(<span class="string">' %0.4f '</span>,SD.C(r))];
0217       <span class="keyword">end</span>;
0218       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(B1,gui,guih,popup);
0219       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(B2,gui,guih,popup);
0220       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(B3,gui,guih,popup);
0221      <span class="keyword">else</span>
0222       B1=[    ]; B2=<span class="string">'B = '</span>;B3=<span class="string">'SD= '</span>;
0223       <span class="keyword">if</span> ~isempty(G.B) <span class="comment">% Could be here in AR case =&gt; no B to print</span>
0224        <span class="keyword">for</span> r=1:G.nB(k)+1
0225         <span class="keyword">if</span> r&gt;1
0226          <span class="keyword">if</span> strcmpi(G.op,<span class="string">'s'</span>)
0227           B1 = [B1,[<span class="string">' '</span>,G.op,<span class="string">'^'</span>,int2str(G.nB(k)-r+1),<span class="string">'   '</span>]];
0228          <span class="keyword">else</span> 
0229           B1 = [B1,[<span class="string">' '</span>,G.op,<span class="string">'^-'</span>,int2str(r-1),<span class="string">'   '</span>]];
0230          <span class="keyword">end</span>;
0231         <span class="keyword">else</span>
0232          <span class="keyword">if</span> strcmpi(G.op,<span class="string">'s'</span>)
0233           B1 = [B1,[<span class="string">'     '</span>,G.op,<span class="string">'^'</span>,int2str(G.nB(k)),<span class="string">'   '</span>,<span class="string">' '</span>]];
0234          <span class="keyword">else</span>
0235           B1 = [B1,[<span class="string">'     1   '</span>,<span class="string">'   '</span>]];
0236          <span class="keyword">end</span>;
0237         <span class="keyword">end</span>;
0238         <span class="keyword">if</span> (G.B(k,r)&lt;0) sp1=<span class="string">''</span>; <span class="keyword">else</span> sp1=<span class="string">' '</span>; <span class="keyword">end</span>;
0239         <span class="keyword">if</span> strcmpi(G.op,<span class="string">'s'</span>)
0240          dB = G.nA(k)-G.nB(k);
0241          B2 = [B2,sp1,sprintf(<span class="string">'%2.3f '</span>,G.B(k,dB+r,m))];
0242         <span class="keyword">else</span>
0243          B2 = [B2,sp1,sprintf(<span class="string">'%0.4f '</span>,G.B(k,r,m))];         
0244         <span class="keyword">end</span>;
0245         <span class="keyword">if</span> [~<a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>] B3 = [B3,sprintf(<span class="string">' %0.4f '</span>,SD.B(k,r))]; <span class="keyword">end</span>;
0246        <span class="keyword">end</span>;
0247        <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(B1,gui,guih,popup); <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(B2,gui,guih,popup); <span class="keyword">if</span> [~<a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>] <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(B3,gui,guih,popup); <span class="keyword">end</span>
0248       <span class="keyword">end</span>
0249      <span class="keyword">end</span>
0250      A1=[    ]; A2=<span class="string">'A = '</span>;A3=<span class="string">'SD=  0      '</span>;
0251      <span class="keyword">for</span> r=1:G.nA(k)+1
0252       <span class="keyword">if</span> r&gt;1
0253        <span class="keyword">if</span> strcmpi(G.op,<span class="string">'s'</span>)       
0254         A1 = [A1,[<span class="string">' '</span>,G.op,<span class="string">'^'</span>,int2str(G.nA(k)-r+1),<span class="string">'   '</span>]];
0255        <span class="keyword">else</span>
0256         A1 = [A1,[<span class="string">' '</span>,G.op,<span class="string">'^-'</span>,int2str(r-1),<span class="string">'   '</span>]];        
0257        <span class="keyword">end</span>;
0258       <span class="keyword">else</span>
0259        <span class="keyword">if</span> strcmpi(G.op,<span class="string">'s'</span>)           
0260         A1 = [A1,[<span class="string">'     '</span>,G.op,<span class="string">'^'</span>,int2str(G.nA(k)),<span class="string">'   '</span>,<span class="string">' '</span>]];        
0261        <span class="keyword">else</span> 
0262         A1 = [A1,[<span class="string">'     1   '</span>,<span class="string">'   '</span>]];
0263        <span class="keyword">end</span>;        
0264       <span class="keyword">end</span>;
0265       <span class="keyword">if</span> (G.A(k,r)&lt;0) sp1=<span class="string">''</span>; <span class="keyword">else</span> sp1=<span class="string">' '</span>; <span class="keyword">end</span>;
0266       <span class="keyword">if</span> strcmpi(G.op,<span class="string">'s'</span>)
0267        A2 = [A2,sp1,sprintf(<span class="string">'%2.3f '</span>,G.A(k,r,m))];       
0268       <span class="keyword">else</span>
0269        A2 = [A2,sp1,sprintf(<span class="string">'%0.4f '</span>,G.A(k,r,m))];
0270       <span class="keyword">end</span>;       
0271       <span class="keyword">if</span> [r&gt;1,~<a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>] A3 = [A3,sprintf(<span class="string">' %0.4f '</span>,SD.A(k,r-1))]; <span class="keyword">end</span>;
0272      <span class="keyword">end</span>;
0273      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0274      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(A1,gui,guih,popup); <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(A2,gui,guih,popup); <span class="keyword">if</span> [~<a href="fir.html" class="code" title="function G = fir(Z,M,OPT)">fir</a>] <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(A3,gui,guih,popup); <span class="keyword">end</span>; <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0275      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'delay = '</span>,int2str(G.delay(k)), <span class="string">' samples'</span>],gui,guih,popup); <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0276      
0277      <span class="comment">% Print out where the poles are</span>
0278      p = cplxpair(roots(G.A(k,1:G.nA(k)+1)));
0279      idx = 1; pls = [];
0280      <span class="keyword">while</span> idx&lt;=G.nA(k)
0281       mg = abs(p(idx)); ph = abs(angle(p(idx)));  <span class="comment">% Complex conj pair?</span>
0282       <span class="keyword">if</span> abs(imag(p(idx)))&gt;0
0283        idx = idx+2;
0284        <span class="keyword">if</span> idx&lt;=G.nA(k) cm=<span class="string">','</span>; <span class="keyword">else</span> cm=<span class="string">'.'</span>; <span class="keyword">end</span>;
0285        pls = [pls,<span class="string">' '</span>,sprintf(<span class="string">'%0.4f*exp(+-j%0.4f)'</span>,mg,ph),cm];
0286       <span class="keyword">else</span>
0287        idx = idx+1;
0288        <span class="keyword">if</span> idx&lt;=G.nA(k) cm=<span class="string">','</span>; <span class="keyword">else</span> cm=<span class="string">'.'</span>; <span class="keyword">end</span>;
0289        pls = [pls,<span class="string">' '</span>,sprintf(<span class="string">'%0.4f'</span>,p(idx-1)),cm];
0290       <span class="keyword">end</span>;
0291      <span class="keyword">end</span>;
0292      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Poles at'</span>,pls],gui,guih,popup)
0293      <span class="comment">%    urdisp(' ');</span>
0294     <span class="keyword">end</span>;  <span class="comment">% End of loop over inputs</span>
0295    <span class="keyword">end</span>; <span class="comment">% End of loop over outputs</span>
0296   <span class="keyword">else</span> <span class="comment">% If too many input output pairs</span>
0297    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0298    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'%d Inputs &amp; %d Outputs =&gt; %d T/Fs: Too many to urdisplay! '</span>,nu,ny,nu*ny),gui,guih,popup);
0299    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0300   <span class="keyword">end</span>;
0301   
0302   <span class="keyword">if</span> any(strcmpi(G.type,{<span class="string">'bj'</span>,<span class="string">'armax'</span>}))
0303    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0304    <span class="keyword">for</span> m=1:ny
0305     <span class="keyword">for</span> k=1:ny
0306      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0307      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'Innovations Input #%d to Output #%d Estimated Spec Fact + stand dev: '</span>,k,m),gui,guih,popup);
0308      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0309      
0310      C1=[    ]; C2=<span class="string">'C = '</span>;C3=<span class="string">'SD=  0      '</span>;   D2=<span class="string">'D = '</span>;D3=C3;
0311      <span class="keyword">for</span> r=1:length(G.C(m,:,k))
0312       <span class="keyword">if</span> r&gt;1
0313        C1 = [C1,[<span class="string">' '</span>,G.op,<span class="string">'^-'</span>,int2str(r-1),<span class="string">'   '</span>]];
0314       <span class="keyword">else</span>
0315        C1 = [C1,[<span class="string">'     1   '</span>,<span class="string">'   '</span>]];
0316       <span class="keyword">end</span>;
0317       <span class="keyword">if</span> (G.C(1,r)&lt;0) sp1=<span class="string">''</span>; <span class="keyword">else</span> sp1=<span class="string">' '</span>; <span class="keyword">end</span>;
0318       C2 = [C2,sp1,sprintf(<span class="string">'%0.4f '</span>,G.C(1,r))];
0319       <span class="keyword">if</span> [r&gt;1] C3 = [C3,sprintf(<span class="string">' %0.4f '</span>,SD.C(1,r-1))]; <span class="keyword">end</span>;
0320       <span class="keyword">if</span> ~armax
0321        <span class="keyword">if</span> (G.D(1,r)&lt;0) sp2=<span class="string">''</span>; <span class="keyword">else</span> sp2=<span class="string">' '</span>; <span class="keyword">end</span>;
0322        D2 = [D2,sp2,sprintf(<span class="string">'%0.4f '</span>,G.D(1,r))];
0323        <span class="keyword">if</span> [r&gt;1] D3 = [D3,sprintf(<span class="string">' %0.4f '</span>,SD.D(1,r-1))]; <span class="keyword">end</span>;
0324       <span class="keyword">end</span>;
0325      <span class="keyword">end</span>;
0326      
0327      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup); <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(C1,gui,guih,popup); <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(C2,gui,guih,popup);
0328      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(C3,gui,guih,popup);
0329      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0330      <span class="keyword">if</span> ~armax
0331       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0332       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(C1,gui,guih,popup);
0333       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(D2,gui,guih,popup);
0334       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(D3,gui,guih,popup);
0335       <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0336      <span class="keyword">end</span>
0337      
0338      <span class="comment">% Print out where the poles/zeros of the noise model are - first for C:</span>
0339      p = cplxpair(roots(G.C(m,:,1))); idx = 1; pls = []; np = length(p);
0340      <span class="keyword">while</span> idx&lt;=np
0341       mg = abs(p(idx)); ph = abs(angle(p(idx)));  <span class="comment">% Complex conj pair?</span>
0342       <span class="keyword">if</span> abs(imag(p(idx)))&gt;0
0343        idx = idx+2; <span class="keyword">if</span> idx&lt;=np cm=<span class="string">','</span>; <span class="keyword">else</span> cm=<span class="string">'.'</span>; <span class="keyword">end</span>;
0344        pls = [pls,<span class="string">' '</span>,sprintf(<span class="string">'%0.4f*exp(+-j%0.4f)'</span>,mg,ph),cm];
0345       <span class="keyword">else</span>
0346        idx = idx+1; <span class="keyword">if</span> idx&lt;=np cm=<span class="string">','</span>; <span class="keyword">else</span> cm=<span class="string">'.'</span>; <span class="keyword">end</span>;
0347        pls = [pls,<span class="string">' '</span>,sprintf(<span class="string">'%0.4f'</span>,p(idx-1)),cm];
0348       <span class="keyword">end</span>;
0349      <span class="keyword">end</span>;
0350      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Zeros of C at:'</span>,pls],gui,guih,popup)
0351      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0352      
0353      <span class="comment">% Now urdisplay zeros of D</span>
0354      p = cplxpair(roots(G.D(m,:,1))); idx = 1; pls = []; np = length(p);
0355      <span class="keyword">while</span> idx&lt;=np
0356       mg = abs(p(idx)); ph = abs(angle(p(idx)));  <span class="comment">% Complex conj pair?</span>
0357       <span class="keyword">if</span> abs(imag(p(idx)))&gt;0
0358        idx = idx+2; <span class="keyword">if</span> idx&lt;=np cm=<span class="string">','</span>; <span class="keyword">else</span> cm=<span class="string">'.'</span>; <span class="keyword">end</span>;
0359        pls = [pls,<span class="string">' '</span>,sprintf(<span class="string">'%0.4f*exp(+-j%0.4f)'</span>,mg,ph),cm];
0360       <span class="keyword">else</span>
0361        idx = idx+1; <span class="keyword">if</span> idx&lt;=np cm=<span class="string">','</span>; <span class="keyword">else</span> cm=<span class="string">'.'</span>; <span class="keyword">end</span>;
0362        pls = [pls,<span class="string">' '</span>,sprintf(<span class="string">'%0.4f'</span>,p(idx-1)),cm];
0363       <span class="keyword">end</span>;
0364      <span class="keyword">end</span>;
0365      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Zeros of D at:'</span>,pls],gui,guih,popup)
0366      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0367     <span class="keyword">end</span>; <span class="comment">% End of loop over input innovation</span>
0368    <span class="keyword">end</span>;  <span class="comment">% End of loop over output number</span>
0369   <span class="keyword">end</span>;  <span class="comment">% End of check on whether there is a noise model worth outputting</span>
0370   
0371   
0372   
0373   <span class="comment">%----------------------------------------------------------------------</span>
0374   <span class="comment">%                            STATE SPACE MODELS</span>
0375   <span class="comment">%----------------------------------------------------------------------</span>
0376  <span class="keyword">case</span> {<span class="string">'ss'</span>,<span class="string">'bilin'</span>,<span class="string">'bilinear'</span>}
0377   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0378   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Details for Estimated Model Structure'</span>],gui,guih,popup);
0379   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0380   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Operator used in model         = '</span>,G.op],gui,guih,popup)
0381   <span class="keyword">if</span> G.T&gt;0,
0382    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Sampling Period                = '</span>,sprintf(<span class="string">'%f '</span>,G.T),<span class="string">'seconds'</span>],gui,guih,popup)
0383   <span class="keyword">else</span>
0384    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Sampling Period                = irregular'</span>],gui,guih,popup)
0385   <span class="keyword">end</span>
0386   <span class="keyword">if</span> G.T&gt;0,
0387    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimated Innovations Variance = '</span>,sprintf(<span class="string">'%e '</span>,trace(G.var))],gui,guih,popup)
0388   <span class="keyword">else</span>
0389    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimated Innovations Variance = '</span>,sprintf(<span class="string">'%e '</span>,trace(G.ss.R))],gui,guih,popup)
0390   <span class="keyword">end</span>
0391   <span class="keyword">switch</span> lower(G.type),
0392    <span class="keyword">case</span> {<span class="string">'ss'</span>,<span class="string">'nss'</span>}
0393     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = Linear State Space'</span>],gui,guih,popup)
0394    <span class="keyword">case</span> {<span class="string">'bilin'</span>,<span class="string">'bilinear'</span>}
0395     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = Bilinear State Space'</span>],gui,guih,popup)
0396    <span class="keyword">otherwise</span>
0397     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Model Structure Used           = Not Specified'</span>],gui,guih,popup)
0398   <span class="keyword">end</span>
0399   
0400   <span class="keyword">if</span> strcmpi(G.alg,<span class="string">'gn'</span>)
0401    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Gauss-Newton search'</span>],gui,guih,popup);
0402   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'em'</span>)
0403    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Expect-Maxim (EM) search'</span>],gui,guih,popup)
0404   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'sid'</span>)
0405    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = N4SID Subspace Regression'</span>],gui,guih,popup)
0406   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'cca'</span>)
0407    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Canonical Correlation Analysis'</span>],gui,guih,popup)
0408   <span class="keyword">elseif</span> strcmpi(G.alg,<span class="string">'n4sid'</span>)
0409    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = N4SID Subspace Regression'</span>],gui,guih,popup)
0410   <span class="keyword">else</span>
0411    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Estimation algorithm           = Not Specified'</span>],gui,guih,popup)
0412   <span class="keyword">end</span>;
0413   
0414   <span class="comment">%Print the model equations</span>
0415   <span class="keyword">if</span> isfield(G,<span class="string">'modelEquations'</span>),
0416    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(sprintf(<span class="string">'\nModel Equations are:'</span>),gui,guih,popup)
0417    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(G.modelEquations,gui,guih,popup)
0418   <span class="keyword">end</span>
0419   
0420   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0421   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">'    State Space Matrices '</span>,gui,guih,popup);
0422   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0423   
0424   frmt = <span class="string">'%11.2e'</span>;
0425   <span class="keyword">if</span> numel(G.ss.A)&gt;0,
0426    str = num2str(G.ss.A,frmt);
0427    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0428     lbl1 = <span class="string">'A  = '</span>;
0429     lbl2 = <span class="string">'     '</span>;
0430    <span class="keyword">else</span>
0431     lbl1 = <span class="string">'A  =  '</span>;
0432     lbl2 = <span class="string">'      '</span>;
0433    <span class="keyword">end</span>
0434    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0435    <span class="keyword">for</span> i=2:size(str,1)
0436     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0437    <span class="keyword">end</span>
0438    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0439   <span class="keyword">end</span>
0440   <span class="keyword">if</span> numel(G.ss.B)&gt;0,
0441    str = num2str(G.ss.B,frmt);
0442    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0443     lbl1 = <span class="string">'B  = '</span>;
0444     lbl2 = <span class="string">'     '</span>;
0445    <span class="keyword">else</span>
0446     lbl1 = <span class="string">'B  =  '</span>;
0447     lbl2 = <span class="string">'      '</span>;
0448    <span class="keyword">end</span>
0449    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0450    <span class="keyword">for</span> i=2:size(str,1)
0451     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0452    <span class="keyword">end</span>
0453    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0454   <span class="keyword">end</span>
0455   <span class="keyword">if</span> numel(G.ss.C)&gt;0,
0456    str = num2str(G.ss.C,frmt);
0457    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0458     lbl1 = <span class="string">'C  = '</span>;
0459     lbl2 = <span class="string">'     '</span>;
0460    <span class="keyword">else</span>
0461     lbl1 = <span class="string">'C  =  '</span>;
0462     lbl2 = <span class="string">'      '</span>;
0463    <span class="keyword">end</span>
0464    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0465    <span class="keyword">for</span> i=2:size(str,1)
0466     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0467    <span class="keyword">end</span>
0468    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0469   <span class="keyword">end</span>
0470   <span class="keyword">if</span> numel(G.ss.D)&gt;0,
0471    str = num2str(G.ss.D,frmt);
0472    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0473     lbl1 = <span class="string">'D  = '</span>;
0474     lbl2 = <span class="string">'     '</span>;
0475    <span class="keyword">else</span>
0476     lbl1 = <span class="string">'D  =  '</span>;
0477     lbl2 = <span class="string">'      '</span>;
0478    <span class="keyword">end</span>
0479    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0480    <span class="keyword">for</span> i=2:size(str,1)
0481     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0482    <span class="keyword">end</span>
0483    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0484   <span class="keyword">end</span>
0485   <span class="keyword">if</span> numel(G.ss.K)&gt;0,
0486    str = num2str(G.ss.K,frmt);
0487    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0488     lbl1 = <span class="string">'K  = '</span>;
0489     lbl2 = <span class="string">'     '</span>;
0490    <span class="keyword">else</span>
0491     lbl1 = <span class="string">'K  =  '</span>;
0492     lbl2 = <span class="string">'      '</span>;
0493    <span class="keyword">end</span>
0494    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0495    <span class="keyword">for</span> i=2:size(str,1)
0496     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0497    <span class="keyword">end</span>
0498    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0499   <span class="keyword">end</span>
0500   <span class="keyword">if</span> numel(G.ss.F)&gt;0,
0501    str = num2str(G.ss.F,frmt);
0502    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0503     lbl1 = <span class="string">'F  = '</span>;
0504     lbl2 = <span class="string">'     '</span>;
0505    <span class="keyword">else</span>
0506     lbl1 = <span class="string">'F  =  '</span>;
0507     lbl2 = <span class="string">'      '</span>;
0508    <span class="keyword">end</span>
0509    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0510    <span class="keyword">for</span> i=2:size(str,1)
0511     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0512    <span class="keyword">end</span>
0513    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0514   <span class="keyword">end</span>
0515   <span class="keyword">if</span> numel(G.ss.G)&gt;0,
0516    str = num2str(G.ss.G,frmt);
0517    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0518     lbl1 = <span class="string">'G  = '</span>;
0519     lbl2 = <span class="string">'     '</span>;
0520    <span class="keyword">else</span>
0521     lbl1 = <span class="string">'G  =  '</span>;
0522     lbl2 = <span class="string">'      '</span>;
0523    <span class="keyword">end</span>
0524    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0525    <span class="keyword">for</span> i=2:size(str,1)
0526     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0527    <span class="keyword">end</span>
0528    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0529   <span class="keyword">end</span>
0530   <span class="keyword">if</span> numel(G.ss.X1)&gt;0,
0531    str = num2str(G.ss.X1,frmt);
0532    <span class="keyword">if</span> any(strfind(str(:,1)',<span class="string">'-'</span>)),
0533     lbl1 = <span class="string">'X1 = '</span>;
0534     lbl2 = <span class="string">'     '</span>;
0535    <span class="keyword">else</span>
0536     lbl1 = <span class="string">'X1 =  '</span>;
0537     lbl2 = <span class="string">'      '</span>;
0538    <span class="keyword">end</span>
0539    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl1 str(1,:)],gui,guih,popup);
0540    <span class="keyword">for</span> i=2:size(str,1)
0541     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([lbl2 str(i,:)],gui,guih,popup);
0542    <span class="keyword">end</span>
0543    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0544   <span class="keyword">end</span>
0545   <span class="keyword">if</span> numel(G.ss.A)&gt;0,
0546    pls = eig(G.ss.A)';
0547    <span class="keyword">if</span> isreal(pls),
0548     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Poles of A  = '</span> num2str(pls,frmt)],gui,guih,popup);
0549    <span class="keyword">else</span>
0550     <span class="comment">%urdisp(['Poles of A             = ' num2str(pls,frmt)],gui,guih,popup);</span>
0551     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Poles of A (magnitude) = '</span> num2str(abs(pls),frmt)],gui,guih,popup);
0552    <span class="keyword">end</span>
0553   <span class="keyword">end</span>
0554 <span class="keyword">end</span>
0555 
0556 <span class="comment">%Extract number of inputs and outputs</span>
0557 nu = G.nu;
0558 ny = G.ny;
0559 
0560 
0561 <span class="comment">%  Now print out details of non-linear parts of model structure and plot</span>
0562 <span class="comment">%  the shape of these non-linearities.fignu</span>
0563 
0564 <span class="comment">% First check to see if there are any input non-linearities to urdisplay</span>
0565 flag = 0; <span class="keyword">for</span> k=1:nu flag=flag+~strcmp(lower(G.in(k).type),<span class="string">'linear'</span>); <span class="keyword">end</span>;
0566 plotnum=1;  <span class="comment">% Initialise count of figure, and plot within figure</span>
0567 
0568 <span class="keyword">if</span> flag
0569  <span class="comment">%fignum=figure;</span>
0570  <span class="comment">%fignum=figure('Visible', 'off', 'IntegerHandle','off');</span>
0571  <span class="keyword">if</span> nargout == 1;
0572   fignum=figure(<span class="string">'Visible'</span>, <span class="string">'off'</span>, <span class="string">'IntegerHandle'</span>,<span class="string">'off'</span>);
0573   handle = [handle fignum];
0574  <span class="keyword">else</span>
0575   fignum=figure;
0576  <span class="keyword">end</span>
0577  <span class="comment">%keyboard</span>
0578  <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'----------------------------------------------------------'</span>],gui,guih,popup)
0579  <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Input Non-linearity Parameters and standard deviations:   '</span>],gui,guih,popup)
0580  <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'----------------------------------------------------------'</span>],gui,guih,popup)
0581  <span class="keyword">for</span> k=1:nu  <span class="comment">% Loop over all inputs</span>
0582   <span class="keyword">if</span> ~strcmpi(G.in(k).type,<span class="string">'linear'</span>)
0583    eval(sprintf(<span class="string">'subplot(%d1%d)'</span>,flag,plotnum));plotnum=plotnum+1;
0584    hold on;
0585    app=<span class="string">'and standard dev:'</span>;
0586    <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([sprintf(<span class="string">'Input block #%d of type '</span>,k),G.in(k).type,<span class="string">' has estimates '</span>,app],gui,guih,popup);
0587    <span class="keyword">if</span> (strcmpi(G.in(k).type,<span class="string">'saturation'</span>) | strcmpi(G.in(k).type,<span class="string">'deadzone'</span>))
0588     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">' '</span>],gui,guih,popup);
0589     app1 = [<span class="string">',sd = '</span>,sprintf(<span class="string">'%5.4f'</span>,SD.in(k).upper)];
0590     app2 = [<span class="string">',sd = '</span>,sprintf(<span class="string">'%5.4f'</span>,SD.in(k).lower)];
0591     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'upper limit = '</span>,sprintf(<span class="string">'%5.4f'</span>,G.in(k).upper),app1],gui,guih,popup)
0592     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'lower limit = '</span>,sprintf(<span class="string">'%5.4f'</span>,G.in(k).lower),app2],gui,guih,popup)
0593     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">' '</span>],gui,guih,popup);
0594     <span class="keyword">if</span> G.in(k).upper&gt;0 maxu = 2*G.in(k).upper; <span class="keyword">else</span> maxu = 0.5*G.in(k).upper; <span class="keyword">end</span>;
0595     <span class="keyword">if</span> G.in(k).lower&gt;0 minu = 0.5*G.in(k).lower; <span class="keyword">else</span> minu = 2*G.in(k).lower; <span class="keyword">end</span>;
0596     utest = minu:(maxu-minu)/100:maxu;
0597     <span class="keyword">if</span> strcmpi(G.in(k).type,<span class="string">'saturation'</span>)
0598      X = <a href="sat.html" class="code" title="function z = sat(u,lower,upper,m)">sat</a>(utest,G.in(k).lower,G.in(k).upper,1);
0599     <span class="keyword">else</span>
0600      X = <a href="dzone.html" class="code" title="function z = dzone(u,lower,upper)">dzone</a>(utest,G.in(k).lower,G.in(k).upper);
0601     <span class="keyword">end</span>;
0602     h=plot(utest,X);  set(h,<span class="string">'Linewidth'</span>,2);
0603     grid; title(sprintf(<span class="string">'Input #%d Nonlinearity'</span>,k));
0604     xlabel(<span class="string">'input u'</span>); ylabel(<span class="string">'X(u)'</span>);
0605    <span class="keyword">elseif</span> strcmpi(G.in(k).type,<span class="string">'hinge'</span>)
0606     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'eta = '</span> num2str(G.in(k).eta(:)',<span class="string">'%0.4f '</span>)],gui,guih,popup)
0607     <span class="keyword">if</span> G.in(k).eta(1)&gt;0,
0608      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'SD  = '</span> num2str(SD.in(k).eta(:)',<span class="string">'%0.4f '</span>)],gui,guih,popup)
0609     <span class="keyword">else</span>
0610      <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'SD  =  '</span> num2str(SD.in(k).eta(:)',<span class="string">'%0.4f  '</span>)],gui,guih,popup)
0611     <span class="keyword">end</span>
0612     <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">' '</span>],gui,guih,popup);
0613     <span class="keyword">if</span> all(abs(G.in(k).eta)&gt;0) <span class="comment">% Avoid divide by zero when guessing relevant ranges</span>
0614      breakpoints = G.in(k).eta(2:2:end)./G.in(k).eta(1:2:end);
0615      minu = -2*min(breakpoints);
0616      maxu = -2*max(breakpoints);
0617     <span class="keyword">else</span>
0618      minu=-10; 
0619      maxu=10; 
0620     <span class="keyword">end</span>;
0621     
0622     
0623     utest = minu:(maxu-minu)/100:maxu; X = <a href="hinge.html" class="code" title="function [x,w] = hinge(u,alpha)">hinge</a>(utest,G.in(k).eta);
0624     h = plot(utest,X); set(h,<span class="string">'Linewidth'</span>,2);
0625     grid; title(sprintf(<span class="string">'Input #%d Nonlinearity'</span>,k));
0626     xlabel(<span class="string">'input u'</span>); ylabel(<span class="string">'X(u)'</span>);
0627     eta = [G.in(k).eta(:),SD.in(k).eta(:)]';
0628    <span class="keyword">elseif</span> strcmpi(G.in(k).type,<span class="string">'poly'</span>)
0629     utest = -3:0.01:3; X = <a href="polynom.html" class="code" title="function [x,phi,w] = polynom(u,alpha)">polynom</a>(utest,G.in(k).eta);
0630     h = plot(utest,X); set(h,<span class="string">'Linewidth'</span>,2);
0631     grid; title(sprintf(<span class="string">'Input #%d Nonlinearity'</span>,k));
0632     xlabel(<span class="string">'input u'</span>); ylabel(<span class="string">'X(u)'</span>);
0633     eta = G.in(k).eta(:)';
0634    <span class="keyword">end</span>;
0635   <span class="keyword">end</span>; <span class="comment">% End of check on whether we hit a linear block as we loop over all inputs</span>
0636  <span class="keyword">end</span>; <span class="comment">% End of loop over inputs</span>
0637  fignum = fignum+1;   <span class="comment">% Subsequent plots on a new figure please</span>
0638 <span class="keyword">end</span>;  <span class="comment">% Test on whether there are any input non-linearities to urdisplay</span>
0639 
0640 <span class="keyword">if</span> ~strcmpi(G.out.type,<span class="string">'linear'</span>)
0641  <span class="keyword">if</span> nargout == 1;
0642   fignum=figure(<span class="string">'Visible'</span>, <span class="string">'off'</span>, <span class="string">'IntegerHandle'</span>,<span class="string">'off'</span>);
0643   handle = [handle fignum];
0644  <span class="keyword">else</span>
0645   fignum=figure;
0646  <span class="keyword">end</span>
0647  <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'----------------------------------------------------------'</span>],gui,guih,popup)
0648  <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'Output Non-linearity Parameters and standard deviations:   '</span>],gui,guih,popup)
0649  <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'----------------------------------------------------------'</span>],gui,guih,popup)
0650  <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([sprintf(<span class="string">'Output block of type '</span>,k),G.out.type,<span class="string">' has estimates and standard dev:'</span>],gui,guih,popup);
0651  <span class="keyword">if</span> (strcmpi(G.out.type,<span class="string">'saturation'</span>) || strcmpi(G.out.type,<span class="string">'deadzone'</span>))
0652   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">' '</span>],gui,guih,popup);
0653   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'upper limit = '</span>,sprintf(<span class="string">'%5.4f'</span>,G.out.upper),<span class="string">', sd = '</span>,sprintf(<span class="string">'%5.4f'</span>,SD.out.upper)],gui,guih,popup)
0654   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">'lower limit = '</span>,sprintf(<span class="string">'%5.4f'</span>,G.out.lower),<span class="string">', sd = '</span>,sprintf(<span class="string">'%5.4f'</span>,SD.out.lower)],gui,guih,popup)
0655   <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>([<span class="string">' '</span>],gui,guih,popup);
0656   <span class="keyword">if</span> G.out.upper&gt;0 maxu = 2*G.out.upper; <span class="keyword">else</span> maxu = 0.5*G.out.upper; <span class="keyword">end</span>;
0657   <span class="keyword">if</span> G.out.lower&gt;0 minu = 0.5*G.out.lower; <span class="keyword">else</span> minu = 2*G.out.lower; <span class="keyword">end</span>;
0658   utest = minu:(maxu-minu)/100:maxu;
0659   <span class="keyword">if</span> strcmpi(G.out.type,<span class="string">'saturation'</span>)
0660    X = <a href="sat.html" class="code" title="function z = sat(u,lower,upper,m)">sat</a>(utest,G.out.lower,G.out.upper,1);
0661   <span class="keyword">else</span>
0662    X = <a href="dzone.html" class="code" title="function z = dzone(u,lower,upper)">dzone</a>(utest,G.out.lower,G.out.upper);
0663   <span class="keyword">end</span>;
0664   h = plot(utest,X);  set(h,<span class="string">'Linewidth'</span>,2);
0665   grid; title(<span class="string">'Output Nonlinearity'</span>);
0666   xlabel(<span class="string">'output y'</span>); ylabel(<span class="string">'X(y)'</span>);
0667  <span class="keyword">elseif</span> strcmpi(G.out.type,<span class="string">'hinge'</span>)
0668   <span class="keyword">if</span> all(abs(G.out.eta)&gt;0) <span class="comment">% Avoid divide by zero when guessing relevant ranges</span>
0669    minu = -2*G.out.eta(3)/G.out.eta(4);
0670    maxu = -2*G.out.eta(length(G.out.eta)-1)/G.out.eta(length(G.out.eta));
0671   <span class="keyword">else</span> minu=-10; maxu=10; <span class="keyword">end</span>;
0672   
0673   
0674   minu = minu-abs(minu);
0675   maxu = maxu+abs(maxu);
0676   
0677   <span class="keyword">if</span> abs(minu-maxu)&gt;sqrt(eps),
0678    utest = minu:(maxu-minu)/100:maxu;
0679   <span class="keyword">else</span>
0680    utest = linspace(-10,10,1000);
0681   <span class="keyword">end</span>
0682   X = <a href="hinge.html" class="code" title="function [x,w] = hinge(u,alpha)">hinge</a>(utest,G.out.eta);
0683   h = plot(utest,X); set(h,<span class="string">'Linewidth'</span>,2);
0684   grid; title(<span class="string">'Output Nonlinearity'</span>); xlabel(<span class="string">'output y'</span>); ylabel(<span class="string">'X(y)'</span>);
0685   eta = [G.out.eta(:),SD.out.eta(:)]';
0686  <span class="keyword">elseif</span> strcmpi(G.out.type,<span class="string">'poly'</span>)
0687   utest = -3:0.01:3; X = <a href="polynom.html" class="code" title="function [x,phi,w] = polynom(u,alpha)">polynom</a>(utest,G.out.eta);
0688   h = plot(utest,X); set(h,<span class="string">'Linewidth'</span>,2);
0689   grid; title(<span class="string">'Output Nonlinearity'</span>); xlabel(<span class="string">'ouput y'</span>); ylabel(<span class="string">'X(y)'</span>);
0690   eta = G.out.eta(:)';
0691  <span class="keyword">end</span>;
0692 <span class="keyword">end</span>;  <span class="comment">% Test on output type being linear</span>
0693 
0694 <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(urline,gui,guih,popup);
0695 <a href="#_sub1" class="code" title="subfunction urdisp(str,guiRunning,guihandle,popup)">urdisp</a>(<span class="string">' '</span>,gui,guih,popup);
0696 
0697 <a name="_sub1" href="#_subfunctions" class="code">function urdisp(str,guiRunning,guihandle,popup)</a>
0698 
0699 <span class="keyword">if</span> guiRunning
0700  popup.append(str);
0701 <span class="keyword">else</span>
0702  disp(str);
0703 <span class="keyword">end</span>
0704 
0705</pre></div>
<hr><address>Generated on Sun 04-May-2025 22:15:31 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>